<!DOCTYPE HTML><html lang="en"><head>    <meta charset="UTF-8">    <title>好衣服</title>    <link rel="stylesheet" href="setColor.css">    <script src="jquery.js"></script>    <script src="alloyimage.js"></script>    <script src="extend.js"></script></head><body><div class="container">   <!-- <div class="header">        改色        <button type="button" class="close">×</button>        <button type="button" class="save">保存</button>    </div>-->    <div class="content">        <div class="img-wrap">            <img src="SY11.png" data-src="SY11.png" id="yifu" />            <div><canvas id="copyImage"></canvas></div>        </div>        <div class="menu">            <div class="basis">                <h4 class="title">基础</h4>                <div class="range-wrap"><p>色相:</p><input type="range"  min="-180" max="180" id="hue" /></div>                <div class="range-wrap"><p>饱和度:</p><input type="range"  min="-50" max="50" id="saturation" /></div>                <div class="range-wrap"><p>亮度:</p><input type="range"  min="-50" max="50" id="intensity" /></div>            </div>            <div class="filter">                <h4 class="title">滤镜</h4>                <div id="toReverse" class="filter-item"><p><span class="square"></span> 互补色</p></div>                <div id="toGray" class="filter-item"><p><span class="square"></span> 黑白色</p><input type="range" min="-50" max="50" /></div>                <div id="normal">原图</div>            </div>        </div>    </div></div><script>    //调节色调/饱和度/亮度    $("#hue,#saturation,#intensity").on("input propertychange",function(){        var H = $("#hue").val(),                S = $("#saturation").val(),                I = $("#intensity").val();        changeModel("setHSI", H, S, I, true);    });    $(".filter-item").click(function(){        $(this).addClass("active").siblings(".filter-item").removeClass("active");    });    //反色    $("#toReverse").click(function(){        changeModel("toReverse");    });    //灰度处理    $("#toGray").click(function(){        var pic = $("#yifu")[0];        var picTranseObj = AlloyImage(pic);        var input = $(this).find("input");        var oldVal = 0;        input.on("input propertychange",function(){            var val = $(this).val();            if(val>oldVal){                val>0 ? picTranseObj.act("Filter.toStrongGray").ps("自然增强").replace(pic) : picTranseObj.act("Filter.toLightGray").ps("自然增强").replace(pic);            }else{                val>0 ? picTranseObj.act("Filter.toStrongGray").ps("自然增强").replace(pic) : picTranseObj.act("Filter.toLightGray").ps("自然增强").replace(pic);            }            oldVal=val;        });    });    //返回原图    $("#normal").click(function(){        changeModel();    });    function Model(model,arg2,arg3,arg4,arg5){        var pic = $("#yifu")[0];        pic.src = $("#yifu").attr("data-src");        if(arguments.length !=0 ){            var picTranseObj = AlloyImage(pic);            picTranseObj.act(model,arg2,arg3,arg4,arg5).replace(pic);        }    }    function changeModel(){        Model.apply(this,arguments);        }    //接收图片    function getImg(src){        $("#yifu").attr({"src":"data:image/png;base64,"+src,"data-src":"data:image/png;base64,"+src});    }    //保存    function postImg(){        //if($("#yifu").attr("src") != $("#yifu").attr("data-src")){        //}        var canvas = document.getElementById("copyImage");        var ctx = canvas.getContext("2d");        var img = document.getElementById("yifu");        var newImage = new Image();        canvas.width = img.offsetWidth;        canvas.height = img.offsetHeight;        ctx.drawImage(img,0,0);        newImage.src = canvas.toDataURL("image/png");        var src = newImage.src;        ctx.clearRect(0,0,canvas.width,canvas.height);        return src;    }</script></body></html>